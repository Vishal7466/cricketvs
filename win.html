<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Cricket Quiz</title>
<style>
body {
    font-family: 'Arial', sans-serif;
    background: #e0f2fe;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

.quiz-container {
    background: #fff;
    padding: 25px 35px;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    width: 100%;
    max-width: 700px;
    text-align: center;
    position: relative;
}

h2 {
    color: #0284c7;
    margin-bottom: 10px;
}

.content-text {
    font-size: 16px;
    color: #0f172a;
    margin-bottom: 20px;
    line-height: 1.5;
}

button {
    padding: 12px 25px;
    margin: 12px 0;
    background: #0284c7;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
}

button:hover:enabled {
    background: #0369a1;
}

button:disabled {
    background: gray;
    cursor: not-allowed;
}

.option-btn {
    display: block;
    width: 100%;
    margin: 10px 0;
    background: #f1f5f9;
    color: #0f172a;
    border: 2px solid #0284c7;
    border-radius: 8px;
    padding: 12px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
}

.option-btn:hover {
    background: #0284c7;
    color: white;
}

.timer {
    font-weight: bold;
    font-size: 18px;
    margin-bottom: 10px;
}

.timer-bar-container {
    width: 100%;
    background: #e2e8f0;
    height: 10px;
    border-radius: 5px;
    margin-bottom: 20px;
    overflow: hidden;
}

.timer-bar {
    height: 100%;
    width: 100%;
    background: #0284c7;
    transition: width 1s linear;
}

.progress-text {
    font-size: 14px;
    color: #0284c7;
    margin-bottom: 5px;
}

.score {
    font-size: 22px;
    font-weight: bold;
    color: #0284c7;
    margin-top: 20px;
}

#userForm {
    display: none;
    text-align: left;
}

#userForm input {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 6px;
    border: 1px solid #0284c7;
}

#userForm label {
    font-weight: bold;
    color: #0284c7;
}

/* ---- Professional start page ---- */
.start-card {
    background: linear-gradient(90deg, #0284c7, #06b6d4);
    color: white;
    border-radius: 15px;
    padding: 30px 20px;
    margin-bottom: 25px;
    text-align: center;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}

.start-card h1 {
    font-size: 28px;
    margin-bottom: 15px;
}

.start-card p {
    font-size: 16px;
    line-height: 1.5;
    margin-bottom: 20px;
}

.jersey-gallery {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 20px;
}

.jersey-gallery img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: 2px solid white;
}

.leaderboard-preview {
    margin-top: 25px;
    text-align: left;
    background: #f1f5f9;
    padding: 15px;
    border-radius: 10px;
}

.leaderboard-preview h3 {
    color: #0284c7;
    margin-bottom: 10px;
}

.leaderboard-preview ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.leaderboard-preview li {
    padding: 5px 0;
    border-bottom: 1px solid #ddd;
    font-weight: bold;
    color: gray;
}
</style>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
</head>
<body>

<div class="quiz-container" id="quizContainer">

  <!-- Start Page -->
<div class="start-card" id="startCard">
    <h1>Cricket Quiz Challenge</h1>
    <p>üéØ Answer all 50 cricket questions and challenge your knowledge! Beat the clock, score high, and be among the top 3 to win your favorite player's jersey. Are you ready to claim your spot at the top? üèè</p>
    
    <div class="jersey-gallery">
        <img src="https://i.ibb.co/mrd73DgJ/61z0-a-Jn-O7-L-SX385.jpg" alt="Jersey 1">
        <img src="https://i.ibb.co/Y44MrMCK/61e-Km-Jtfv-VL-AC-UY350.jpg" alt="Jersey 2">
        <img src="https://i.ibb.co/M5ghDr0L/61hgpax1-Ql-L-AC-UY1100.jpg" alt="Jersey 3">
    </div>

    <p><strong>Note:</strong> üìù The top 3 players will be declared based on <strong>score (50/50 first)</strong> and <strong>time taken to complete the quiz</strong>. Aim for both accuracy and speed! ‚è±Ô∏èüèè</p>

    <p><strong>Last Top Players:</strong></p>
    <div class="leaderboard-preview">
        <h3>Leaderboard</h3>
        <ul>
            <li>Vikash Mishra - 50/50</li>
            <li>Arun Khatri - 50/50</li>
            <li>Shubham Rao - 50/50</li>
        </ul>
    </div>
    <button id="startBtn">Start Quiz</button>
</div>

    <!-- User Form -->
    <form id="userForm">
        <label for="username">Name:</label>
        <input type="text" id="username" required>
        <label for="email">Email:</label>
        <input type="email" id="email" required>
        <button type="submit">Submit</button>
    </form>

</div>

<script>
// Firebase config
const firebaseConfig = {
    apiKey: "AIzaSyClsCvupI-zY8i4lMUPOuI_kNqZvCDRs08",
    authDomain: "cricketvs-5e595.firebaseapp.com",
    projectId: "cricketvs-5e595",
    storageBucket: "cricketvs-5e595.appspot.com",
    messagingSenderId: "947578850537",
    appId: "1:947578850537:web:67d84cf056fb50b1c3f478",
    measurementId: "G-S71DWGH252"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const quizContainer = document.getElementById('quizContainer');
const startBtn = document.getElementById('startBtn');
const userForm = document.getElementById('userForm');
const startCard = document.getElementById('startCard');

let quizQuestions = [
    {question: "Who won the 2019 Cricket World Cup?", options: ["India","England","Australia","New Zealand"], answer: "England"},
    {question: "Which player is known as 'Hitman'?", options: ["MS Dhoni","Rohit Sharma","Virat Kohli","David Warner"], answer: "Rohit Sharma"},
    {question: "Who has the highest individual score in ODI?", options: ["Rohit Sharma","Martin Guptill","Chris Gayle","Sachin Tendulkar"], answer: "Rohit Sharma"},
    {question: "Who is the captain of India in T20I 2025?", options: ["Rohit Sharma","Virat Kohli","KL Rahul","Hardik Pandya"], answer: "Rohit Sharma"},
    {question: "Which country hosted 2023 Cricket World Cup?", options: ["India","England","Australia","South Africa"], answer: "India"},
];
quizQuestions = quizQuestions.sort(() => 0.5 - Math.random()).slice(0, 50);

let currentQuestion = 0;
let score = 0;
let timer;
let timeLeft = 15;
let currentUser = "";
let currentEmail = "";

// Show form on start click
startBtn.addEventListener('click', () => {
    startCard.style.display = 'none';
    userForm.style.display = 'block';
});

// Handle form submission
userForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = document.getElementById('username').value.trim();
    const email = document.getElementById('email').value.trim();
    if(!name || !email) return alert("Please enter both name and email");

    currentUser = name;
    currentEmail = email;

    // Check if user already completed quiz
    const querySnapshot = await db.collection("user").where("email", "==", email).get();
    if(!querySnapshot.empty){
        const docData = querySnapshot.docs[0].data();
        if(docData.quizComplete){
            userForm.style.display = 'none';
            startCard.style.display = 'block';
            startBtn.disabled = true;
            startBtn.textContent = "Better Luck Next Time";
            return;
        }
    }

    // Add new user
    await db.collection("user").add({
        name: name,
        email: email,
        quizComplete: false,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });

    userForm.style.display = 'none';
    showQuestion();
});

// ---- Quiz Functions ----
function showQuestion() {
    if(currentQuestion >= quizQuestions.length){
        showScore();
        return;
    }
    const q = quizQuestions[currentQuestion];
    const optionsShuffled = q.options.sort(() => 0.5 - Math.random());

    quizContainer.innerHTML = `
        <div style="text-align:left; font-weight:bold; margin-bottom:10px;">Player: ${currentUser}</div>
        <div class="progress-text">Question ${currentQuestion + 1} / ${quizQuestions.length}</div>
        <div class="timer-bar-container"><div class="timer-bar" id="timerBar"></div></div>
        <div class="timer" id="timer">Time Left: 15s</div>
        <h3>${q.question}</h3>
        <button class="option-btn">${optionsShuffled[0]}</button>
        <button class="option-btn">${optionsShuffled[1]}</button>
        <button class="option-btn">${optionsShuffled[2]}</button>
        <button class="option-btn">${optionsShuffled[3]}</button>
    `;
    const optionBtns = document.querySelectorAll('.option-btn');
    optionBtns.forEach(btn => {
        btn.addEventListener('click', () => checkAnswer(btn.textContent));
    });

    timeLeft = 15;
    const timerBar = document.getElementById('timerBar');
    document.getElementById('timer').textContent = `Time Left: ${timeLeft}s`;
    clearInterval(timer);
    timer = setInterval(() => {
        timeLeft--;
        document.getElementById('timer').textContent = `Time Left: ${timeLeft}s`;
        timerBar.style.width = `${(timeLeft/15)*100}%`;
        if(timeLeft <= 0){
            clearInterval(timer);
            currentQuestion++;
            showQuestion();
        }
    }, 1000);
}

async function checkAnswer(selected) {
    const correct = quizQuestions[currentQuestion].answer;
    if(selected === correct) score++;
    clearInterval(timer);
    currentQuestion++;
    showQuestion();
}

async function showScore() {
    const querySnapshot = await db.collection("users").where("email", "==", currentEmail).get();
    if(!querySnapshot.empty){
        const docId = querySnapshot.docs[0].id;
        await db.collection("users").doc(docId).update({ quizComplete: true });
    }

    quizContainer.innerHTML = `
        <h2>Quiz Completed!</h2>
        <p class="score">Player: ${currentUser}</p>
        <p class="score">Your Score: ${score} / ${quizQuestions.length}</p>
        <button onclick="location.reload()">Retry Quiz</button>
    `;
}
</script>
</body>
</html>
